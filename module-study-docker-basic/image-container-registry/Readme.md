## 이미지, 컨테이너, 이미지 레지스트리

-------

### 이미지란 ?

특정 시점의 파일시스템(디렉터리)을 저장한 압축 파일 <br>
**특정 서버를 실행할 수 있는 상태를 저장한 압축 파일** <br>
이미지를 컨테이너로 실행 <br>
이미지 파일 + 이미지 메타데이터 <br>

**프로그램 vs 프로세스**

| 프로그램          | 프로세스               |
|---------------|--------------------|
| 실행 가능한 소프트 웨어 | 실행 상태의 소프트 웨어      |
| 디스크 공간만 차지    | CPU, MEM 등의 리소스 사용 |
| 1             | N                  |

**이미지 vs 컨테이너**

|이미지 | 컨테이너                             |
|---------------|----------------------------------|
| 실행 가능한 소프트웨어 <br> + 디스크 공간 차지 | 실행 상태의 이미지                       |
| 디스크 공간만 차지 | CPU, MEM 등의 리소스 사용               |
| 1 | N                                |
| | 컨테이너 간 리소스 격리                    |
| | 실행 시 이미지를 복사해 <br> `격리된 디스크 공간 생성` |
| | 실행 시 프로세스도 함께 실행                 |

### 명령어

- `docker image ls` : 로컬 이미지 조회
- `docker image ls (이미지명)` : 특정 이미지 조회
- `docker run -d --name {컨테이너명} 이미지명` : 컨테이너 실행 <br>
  ( -d : 백그라운드 실행, --name {컨테이너명} : 컨테이너의 이름 지정 )
- `docker ps` : 실행 중인 컨테이너 리스트 조회
- `docker rm -f` : 실행 중인 컨테이너 삭제

### 이미지 메타데이터

여러 메타데이터 중 ENV 와 CMD 는 알아두자. <br>
`ENV` : 소프트웨어가 실행 시 참조할 설정 정보 <br>
`CMD` : 컨테이너 실행 시 프로세스 실행 명령어 지정

### 명령어

- `docker image inspect 이미지명` : 이미지의 세부 정보 조회
- `docker container inspect 컨테이너명` : 컨테이너의 세부 정보 조회
- `docker run {컨테이너명} 이미지명 (실행명령)` : 컨테이너 실행 시 메타데이터의 CMD 정보 덮어쓰기
- `docker run --env KEY=VALUE 이미지명` : 컨테이너 실행 시 메타데이터의 ENV 정보 덮어쓰기
- `docker logs (컨테이너명)` : 컨테이너의 로그 조회

### 이미지 레지스트리

이미지를 공유하는 저장소로 이미지 검색, 이미지 버전 관리, 이미지 보안 등의 역할을 한다. <br>
로컬 레지스트리(호스트 머신의 로컬 스토리지), 퍼블릭 레지스트리, 프라이빗 레지스트리로 3가지 종류가 있다.

### 이미지명 규칙

> ✅ 레지스트리주소/프로젝트명/이미지명:이미지태그

### 명령어

- `docker pull 이미지명` : 로컬 스토리지로 이미지 다운로드
- `docker tag 기존이미지명 추가할이미지명` : 로컬스토리지의 이미지명 추가
- `docker push 이미지명` : 이미지 레지스트리에 이미지 업로드
- `docker login` : 이미지 레지스트리 인증 정보 생성
- `docker logout` : 이미지 레지스트리 인증 정보 삭제
- `docker image rm 이미지명` : 로컬 스토리지의 이미지 삭제
